model Conversation {
  id         String    @id @default(cuid())
  title      String?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  messages   Message[]
  documentId String?

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  totalInputTokens  Int   @default(0)
  totalOutputTokens Int   @default(0)
  totalTokens       Int   @default(0)
  metadata          Json?
}

model Message {
  id             String       @id @default(cuid())
  conversationId String
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  role           MessageRole  @default(user)
  content        String
  timestamp      DateTime     @default(now())

  inputTokens  Int?
  outputTokens Int?
  totalTokens  Int?

  metadata Json?
}

enum MessageRole {
  user
  assistant
  system
}
